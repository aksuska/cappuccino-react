{"version":3,"sources":["../../src/Foundation/CPObject.js"],"names":["sprintf","require","CPObject","constructor","$$oidCounter","$$UID","$$uidString","initialized","hasOwnProperty","$$initialized","anything","description","name","debugDescription","superclass","Object","getPrototypeOf","exposedBindings","$$exposedBindings","observationInfo","$$observationInfo","className","initialize","load","alloc","new","init","copyWithZone_","zone","mutableCopyWithZone_","class","isSubclassOfClass_","aClass","create","prototype","conformsToProtocol_","protocol","$$conformsTo","includes","respondsToSelector_","aSelector","resolveClassMethod_","instancesRespondToSelector_","instance","Reflect","has","resolveInstanceMethod_","instanceMethodForSelector_","args","sel","forwardingTargetForSelector_","methodSignatureForSelector_","forwardInvocation_","invocation","doesNotRecognizeSelector_","get","selector","copy","push"],"mappings":"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","file":"CPObject.js","sourcesContent":["/**\n * Base class from which all Objective-J objects should derive\n **/\n\nimport objj_msgSend, {objj_propGuard, objj_function, objj_string, objj_methodSignature, objj_throw_arg} from '../Objective-J';\nconst sprintf = require('sprintf-js').sprintf;\n\nexport default class CPObject {\n\n\tstatic $$oidCounter = 0;\n\tstatic $$initialized = false;\n\tstatic $$conformsTo = [];\n\n\t$$UID = null;\n\t$$exposedBindings = null;\n\t$$observationInfo = null;\n\n\tconstructor() {\n\t\tthis.constructor.$$oidCounter = this.constructor.$$oidCounter + 1;\n\t\tthis.$$UID = this.constructor.$$oidCounter;\n\t}\n\n\t// private method to return UID as hex value\n\t$$uidString() {\n\t\treturn sprintf(\"x%06x\", this.$$UID);\n\t}\n\n\t/*\n\t\t\t\tACCESSORS\n\t */\n\n\t// we need to use the conditional getter or all subclasses will inherit the value\n\tstatic get initialized() {\n\t\treturn this.hasOwnProperty(\"$$initialized\") ? this.$$initialized : false;\n\t}\n\tstatic set initialized(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tstatic get description() {return objj_string(this.name);}\n\tstatic set description(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tstatic get debugDescription() {return this.description();}\n\tstatic set debugDescription(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tstatic get superclass() {return (this === CPObject) ? null : Object.getPrototypeOf(this);}\n\tstatic set superclass(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tget superclass() {return (this.constructor === CPObject) ? null : Object.getPrototypeOf(this.constructor);}\n\tset superclass(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tget exposedBindings() {return this.$$exposedBindings;}\n\tset exposedBindings(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tget observationInfo() {return this.$$observationInfo;}\n\tset observationInfo(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tget className() {return objj_string(this.constructor.name);}\n\tset className(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tget description() {return objj_string(`<${this.constructor.name}: ${this.$$uidString()}>`);}\n\tset description(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\tget debugDescription() {return this.description();}\n\tset debugDescription(anything) {objj_throw_arg(\"Assignment to readonly property\");}\n\n\t/*\n\t\t\t\tCLASS METHODS\n\t */\n\n\tstatic initialize() {\n\t\t// default nothing\n\t}\n\n\tstatic load() {\n\t\t// default nothing\n\t}\n\n\tstatic alloc() {\n\t\treturn new this();\n\t}\n\n\tstatic new() {\n\t\treturn this.alloc().init();\n\t}\n\n\tstatic copyWithZone_(zone = null) {\n\t\t// all class objects are unique\n\t\treturn this;\n\t}\n\n\tstatic mutableCopyWithZone_(zone = null) {\n\t\t// all class objects are unique\n\t\treturn this;\n\t}\n\n\tstatic class() {\n\t\treturn this;\n\t}\n\n\tstatic isSubclassOfClass_(aClass) {\n\t\treturn typeof aClass === 'object' ? Object.create(this.prototype) instanceof aClass : false;\n\t}\n\n\tstatic conformsToProtocol_(protocol) {\n\t\treturn this.$$conformsTo.includes(protocol.name);\n\t}\n\n\tstatic respondsToSelector_(aSelector) {\n\t\treturn (typeof this[objj_function(aSelector)] === 'function' || this.resolveClassMethod_(aSelector));\n\t}\n\n\tstatic instancesRespondToSelector_(aSelector) {\n\t\t// we can't call respondsToSelector as it may be overridden for forwarding, as this method must test only the implemented methods of the class\n\t\tconst instance = this.new();\n\t\treturn (instance) ? (Reflect.has(instance, objj_function(aSelector)) || this.resolveInstanceMethod_(aSelector)) : false;\n\t}\n\n\tstatic instanceMethodForSelector_(aSelector) {\n\t\tif (this.instancesRespondToSelector_(aSelector)) {\n\t\t\treturn (...args) => objj_msgSend(this, aSelector, ...args);\n\t\t}\n\t\telse {\n\t\t\treturn (...args) => objj_msgSend(this, 'doesNotRecognizeSelector:', aSelector);\n\t\t}\n\t}\n\n\tstatic resolveClassMethod_(sel) {\n\t\treturn false;\n\t}\n\n\t/* Caveat: adding instance properties or defining accessor methods for existing properties must be accomplished using Object.defineProperty() with defined getter/setters */\n\tstatic resolveInstanceMethod_(sel) {\n\t\treturn false;\n\t}\n\n\tstatic forwardingTargetForSelector_(aSelector) {\n\t\treturn null;\n\t}\n\n\tstatic methodSignatureForSelector_(aSelector) {\n\t\tif (this.respondsToSelector_(aSelector)) {\n\t\t\treturn objj_methodSignature(this, aSelector);\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic forwardInvocation_(invocation) {\n\t\tthis.doesNotRecognizeSelector_(objj_propGuard(invocation, 'selector'));\n\t}\n\t\n\tstatic doesNotRecognizeSelector_(aSelector) {\n\t\tobjj_throw_arg(\"+[%s %s]: unrecognized selector sent to class\", this.name, aSelector);\n\t}\n\n\t/*\n\t\t\t\tINSTANCE METHODS\n\t */\n\n\n\tinit() {\n\t\tthis.$$exposedBindings = [];\n\t\tthis.$$observationInfo = {};\n\n\t\treturn this;\n\t}\n\n\tclass() {\n\t\treturn this.constructor;\n\t}\n\n\tconformsToProtocol_(protocol) {\n\t\treturn this.constructor.$$conformsTo.includes(protocol.name);\n\t}\n\n\trespondsToSelector_(aSelector) {\n\t\treturn (typeof Reflect.get(this, aSelector) === 'function' || this.class().resolveInstanceMethod_(aSelector));\n\t}\n\n\tforwardingTargetForSelector_(aSelector) {\n\t\treturn null;\n\t}\n\n\tmethodSignatureForSelector_(aSelector) {\n\t\tif (this.respondsToSelector_(aSelector)) {\n\t\t\treturn objj_methodSignature(this, aSelector);\n\t\t}\n\t\treturn null;\n\t}\n\n\tforwardInvocation_(invocation) {\n\t\tthis.doesNotRecognizeSelector_(invocation.selector);\n\t}\n\n\tdoesNotRecognizeSelector_(aSelector) {\n\t\tobjj_throw_arg(\"-[%@ %s]: unrecognized selector sent to instance %s\", this.className, aSelector, this.$$uidString());\n\t}\n\n\tcopy() {\n\t\treturn objj_msgSend(this, 'copyWithZone:', null);\n\t}\n}\n\nCPObject.$$conformsTo.push('CPObject');\n"]}